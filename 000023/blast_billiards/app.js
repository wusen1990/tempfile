
function initSplash(){gameState="splash",resizeCanvas(),splash=new Elements.Splash(assetLib.getData("splash"),assetLib.getData("mbAnim"),canvas.width,canvas.height),userInput.addHitArea("moreGames",butEventHandler,null,"rect",{aRect:[0,0,canvas.width,canvas.height]},!0),previousTime=(new Date).getTime(),updateSplashScreenEvent()}function initStartScreen(){gameState="start",userInput.removeHitArea("moreGames");try{BM_API.getAnalytics().eventMainMenu()}catch(a){console.log("BOOSTERMEDIA_MAINMENU not implemented.")}playSound("pot1"),totalScore=0,background=new Elements.Background(assetLib.getData("background"),canvas.width,canvas.height),userInput.addHitArea("mute",butEventHandler,null,"rect",{aRect:[740,0,canvas.width,55]},!0);var b={oImgData:assetLib.getData("logo"),aPos:[122,22],isStill:!0,scale:1,frame:0},c={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2+280,265],scale:1,frame:1},d={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2-280,265],scale:1,frame:0};userInput.addHitArea("moreGames",butEventHandler,null,"image",b),userInput.addHitArea("startGame",butEventHandler,null,"image",c),userInput.addHitArea("moreGames",butEventHandler,null,"image",d);var e=new Array(c,d,b);panel=new Elements.Panel(assetLib.getData("panels"),assetLib.getData("levelNumbers"),gameState,e,canvas.width,canvas.height),panel.startTween1(),previousTime=(new Date).getTime(),updateStartScreenEvent()}function initGame(){if(gameState="game",0==levelNum)try{BM_API.getAnalytics().eventLevelStart()}catch(a){console.log("BOOSTERMEDIA_START_GAME not implemented.")}shotsSinceLastPot=1,levelScore=0,shotScore=100,userInput.addHitArea("pause",butEventHandler,null,"rect",{aRect:[0,0,55,55]},!0),userInput.addHitArea("gameTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,0,canvas.width,canvas.height]},!0),hud=new Elements.Hud(assetLib.getData("hud"),assetLib.getData("levelNumbers"),canvas.width,canvas.height,totalScore,levelNum);var b=new Array;aBalls=new Array,aHoles=new Array,aDynamites=new Array;for(var c=0;c<aLevelData[levelNum].aData.length;c++)if("cueBall"==aLevelData[levelNum].aData[c].type)cueBall=new Elements.Ball(assetLib.getData("ball"),assetLib.getData("explosion"),assetLib.getData("ballNumbers"),assetLib.getData("potNumbers"),{type:"cueBall",x:aLevelData[levelNum].aData[c].p0.x,y:aLevelData[levelNum].aData[c].p0.y},ballCallback,canvas.width,canvas.height),aBalls.push(cueBall);else if("hole"==aLevelData[levelNum].aData[c].type)aHoles.push({x:aLevelData[levelNum].aData[c].p0.x,y:aLevelData[levelNum].aData[c].p0.y});else if("ball"==aLevelData[levelNum].aData[c].type){var d=new Elements.Ball(assetLib.getData("ball"),assetLib.getData("explosion"),assetLib.getData("ballNumbers"),assetLib.getData("potNumbers"),{type:"ball",timer:aLevelData[levelNum].aData[c].p1.x,x:aLevelData[levelNum].aData[c].p0.x,y:aLevelData[levelNum].aData[c].p0.y},ballCallback,canvas.width,canvas.height);aBalls.push(d)}else if("blackBall"==aLevelData[levelNum].aData[c].type){var d=new Elements.Ball(assetLib.getData("ball"),assetLib.getData("explosion"),assetLib.getData("ballNumbers"),assetLib.getData("potNumbers"),{type:"blackBall",timer:aLevelData[levelNum].aData[c].p1.x,x:aLevelData[levelNum].aData[c].p0.x,y:aLevelData[levelNum].aData[c].p0.y},ballCallback,canvas.width,canvas.height);aBalls.push(d)}else"wall"==aLevelData[levelNum].aData[c].type&&b.push({p0:aLevelData[levelNum].aData[c].p0,p1:aLevelData[levelNum].aData[c].p1,b:1,f:1});if(levelNum>=2){var e=getNewSafeBallPos(),f=new Elements.Dynamite(assetLib.getData("explosion"),ballCallback,{x:e.x,y:e.y},canvas.width,canvas.height);aDynamites.push(f),e=getNewSafeBallPos(),cueBall=new Elements.Ball(assetLib.getData("ball"),assetLib.getData("explosion"),assetLib.getData("ballNumbers"),assetLib.getData("potNumbers"),{type:"cueBall",x:e.x,y:e.y},ballCallback,canvas.width,canvas.height),aBalls.push(cueBall);for(var c=0;6>c;c++){e=getNewSafeBallPos();var d=new Elements.Ball(assetLib.getData("ball"),assetLib.getData("explosion"),assetLib.getData("ballNumbers"),assetLib.getData("potNumbers"),{type:"ball",timer:aLevelData[levelNum].aData[c].p1.x,x:e.x,y:e.y},ballCallback,canvas.width,canvas.height);aBalls.push(d)}}oPosData={prevBallX:cueBall.oData.x,prevBallY:cueBall.oData.y,stageX:-(levelWidth-canvas.width)/2,stageY:-(levelHeight-canvas.height)/2,targStageX:-(levelWidth-canvas.width)/2,targStageY:-(levelHeight-canvas.height)/2,startDragX:0,startDragY:0,startStageX:0,startStageY:0},gameTouchState=0,table=new Elements.Table(assetLib.getData("table"+((levelNum+1)%2+1)),canvas.width,canvas.height),arrow=new Elements.Arrow(assetLib.getData("arrow"),assetLib.getData("cue"),canvas.width,canvas.height),aimX=targAimX=cueBall.startX,aimY=targAimY=cueBall.startY+oPosData.stageY,timer=aLevelData[levelNum].timer,timerRunning=!0,physics2D=new Utils.Physics2D(b,aBalls),previousTime=(new Date).getTime(),updateGameEvent()}function butEventHandler(a,b){switch(a){case"langSelect":console.log(b.lang),curLang=b.lang,ctx.clearRect(0,0,canvas.width,canvas.height),userInput.removeHitArea("langSelect"),initLoadAssets();break;case"startGame":playSound("ballHit1"),userInput.removeHitArea("startGame"),userInput.removeHitArea("moreGames"),initGame();break;case"moreGames":case"moreGamesPause":try{BM_API.getGeneric().showMoreGames()}catch(c){console.log("BOOSTERMEDIA_MORE_GAMES not implemented.")}break;case"continue":playSound("ballHit1"),userInput.removeHitArea("continue"),initGame();break;case"gameTouch":if(gameTouchState>=3)return;if(b.isBeingDragged&&!b.hasLeft)2==gameTouchState&&(targAimX=b.x,targAimY=b.y),arrow.alpha=1;else if(b.isDown)TweenLite.killTweensOf(oPosData),toggleHudButs(!1),b.x<cueBall.x+40&&b.x>cueBall.x-40&&b.y<cueBall.y+40&&b.y>cueBall.y-40&&(gameTouchState=2,aimX=targAimX=b.x,aimY=targAimY=b.y,cueBall.changeState("aiming")),arrow.alpha=b.hasLeft?.5:1;else{if(toggleHudButs(!0),2==gameTouchState&&arrow.scaleX>.1)return gameTouchState=3,arrow.takeShot(cueBall),arrow.scaleX<.5?playSound("strike1"):arrow.scaleX<.8?playSound("strike2"):playSound("strike3"),void 0;gameTouchState=0,"waiting"!=cueBall.state&&cueBall.changeState("waiting")}break;case"nextLevel":playSound("ballHit1"),userInput.removeHitArea("quitFromEndLevel"),userInput.removeHitArea("nextLevel"),userInput.removeHitArea("moreGames"),initGame();break;case"replayLevel":playSound("ballHit1"),userInput.removeHitArea("quitFromEndLevel"),userInput.removeHitArea("replayLevel"),userInput.removeHitArea("moreGames");try{}catch(c){console.log("BOOSTERMEDIA_RESTART not implemented")}initGame();break;case"replayFromEndLevel":playSound("ballHit1"),userInput.removeHitArea("quitFromEndLevel"),userInput.removeHitArea("nextLevel"),userInput.removeHitArea("replayFromEndLevel"),userInput.removeHitArea("moreGames");try{}catch(c){console.log("BOOSTERMEDIA_RESTART not implemented")}levelScore=0,initGame();break;case"quitFromEndLevel":playSound("ballHit1"),userInput.removeHitArea("replayFromEndLevel"),userInput.removeHitArea("quitFromEndLevel"),userInput.removeHitArea("nextLevel"),userInput.removeHitArea("moreGames"),initStartScreen();break;case"mute":playSound("ballHit1"),toggleMute();break;case"pause":case"resumeFromPause":playSound("ballHit1"),toggleManualPause();break;case"replayFromPause":playSound("ballHit1");try{}catch(c){console.log("BOOSTERMEDIA_RESTART not implemented")}gameState="pauseReplay",toggleManualPause(),userInput.removeHitArea("pause"),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("resumeFromPause"),userInput.removeHitArea("replayFromPause"),levelScore=0,totalScore=0,initGame();break;case"quitFromPause":playSound("ballHit1"),toggleManualPause(),userInput.removeHitArea("pause"),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("resumeFromPause"),userInput.removeHitArea("replayFromPause"),levelScore=0,totalScore=0,initStartScreen()}}function updateScore(a){levelScore+=a,hud.updateScore(bonusScore,levelScore+totalScore)}function updateBonusScore(a){bonusScore+=a,levelBonusScore+=a,hud.updateScore(bonusScore,levelScore+totalScore)}function initLevelComplete(){gameState="levelComplete";try{BM_API.getAnalytics().eventLevelComplete()}catch(a){console.log("BOOSTERMEDIA_LEVELCOMPLETE not implemented.")}levelNum++,playSound("levelSuccess"),userInput.removeHitArea("pause"),userInput.removeHitArea("gameTouch");var b={oImgData:assetLib.getData("uiButs"),aPos:[225,300],scale:1,frame:3},c={oImgData:assetLib.getData("uiButs"),aPos:[575,300],scale:1,frame:6},d={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2,300],scale:1,frame:0};userInput.addHitArea("quitFromEndLevel",butEventHandler,null,"image",b),userInput.addHitArea("nextLevel",butEventHandler,null,"image",c),userInput.addHitArea("moreGames",butEventHandler,null,"image",d);var e=new Array(b,c,d);panel=new Elements.Panel(assetLib.getData("panels"),assetLib.getData("potNumbers"),gameState,e,canvas.width,canvas.height),totalScore+=levelScore,panel.oScoreData={levelScore:levelScore,totalScore:totalScore},panel.startTweenEndLevel(),previousTime=(new Date).getTime(),updateLevelComplete()}function initGameComplete(){gameState="gameComplete";try{BM_API.getAnalytics().eventGameComplete()}catch(a){console.log("BOOSTERMEDIA_GAMECOMPLETE not implemented.")}try{var b={scoreValue:totalScore};BM_API.getHighscores().submitHighscores([b])}catch(a){console.log("BOOSTERMEDIA_SUBMITSCORE not implemented. Gained score is: {"+totalScore+"}")}playSound("levelSuccess"),userInput.removeHitArea("pause"),userInput.removeHitArea("gameTouch");var c={oImgData:assetLib.getData("uiButs"),aPos:[225,300],scale:1,frame:3},d={oImgData:assetLib.getData("uiButs"),aPos:[575,300],scale:1,frame:4},e={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2,300],scale:1,frame:0};userInput.addHitArea("quitFromEndLevel",butEventHandler,null,"image",c),userInput.addHitArea("quitFromEndLevel",butEventHandler,null,"image",d),userInput.addHitArea("moreGames",butEventHandler,null,"image",e);var f=new Array(c,d,e);panel=new Elements.Panel(assetLib.getData("panels"),assetLib.getData("potNumbers"),gameState,f,canvas.width,canvas.height),totalScore+=levelScore,panel.oScoreData={levelScore:levelScore,totalScore:totalScore},panel.startTweenEndLevel(),previousTime=(new Date).getTime(),updateGameComplete()}function initLevelFail(){gameState="levelFail";try{BM_API.getAnalytics().eventLevelFailed()}catch(a){console.log("BOOSTERMEDIA_LEVELFAILED not implemented.")}try{var b={scoreValue:totalScore};BM_API.getHighscores().submitHighscores([b])}catch(a){console.log("BOOSTERMEDIA_SUBMITSCORE not implemented. Gained score is: {"+totalScore+"}")}for(var c=0;c<aBalls.length;c++)aBalls[c].destroy();userInput.removeHitArea("pause"),userInput.removeHitArea("gameTouch");var d={oImgData:assetLib.getData("logo"),aPos:[122,378],isStill:!0,scale:1,frame:0},e={oImgData:assetLib.getData("uiButs"),aPos:[225,300],scale:1,frame:3},f={oImgData:assetLib.getData("uiButs"),aPos:[575,300],scale:1,frame:2},g={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2,300],scale:1,frame:0};userInput.addHitArea("moreGames",butEventHandler,null,"image",d),userInput.addHitArea("quitFromEndLevel",butEventHandler,null,"image",e),userInput.addHitArea("replayLevel",butEventHandler,null,"image",f),userInput.addHitArea("moreGames",butEventHandler,null,"image",g);var h=new Array(e,f,g,d);panel=new Elements.Panel(assetLib.getData("panels"),assetLib.getData("potNumbers"),gameState,h,canvas.width,canvas.height),panel.oScoreData={totalScore:totalScore},panel.startTweenEndLevel(),previousTime=(new Date).getTime(),updateLevelFail()}function isNearHole(a,b){var c=a.trackX-b.x,d=a.trackY-b.y,e=c*c+d*d;return 750>e?!0:!1}function isNearDynamite(a,b){var c=a.trackX-b.trackX,d=a.trackY-b.trackY,e=c*c+d*d;return 1400>e?!0:!1}function toggleHudButs(a){a?(userInput.addHitArea("mute",butEventHandler,null,"rect",{aRect:[740,0,canvas.width,55]},!0),userInput.addHitArea("pause",butEventHandler,null,"rect",{aRect:[0,0,55,55]},!0),userInput.addHitArea("gameTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,0,canvas.width,canvas.height]},!0)):(userInput.removeHitArea("mute"),userInput.removeHitArea("pause"))}function getNewSafeBallPos(){for(var a=!1,b=0,c=500*Math.random()+150,d=200*Math.random()+140;!a;){var e=!1;if(aBalls.length>0)for(var f=0;f<aBalls.length;f++){if(c>aBalls[f].startX-2*aBalls[f].ballRadius&&c<aBalls[f].startX+2*aBalls[f].ballRadius&&d>aBalls[f].startY-2*aBalls[f].ballRadius&&d<aBalls[f].startY+2*aBalls[f].ballRadius){c=500*Math.random()+150,d=200*Math.random()+140,e=!1;break}e=!0}else e=!0;var g=!1;if(aDynamites.length>0)for(var f=0;f<aDynamites.length;f++){if(c>aDynamites[f].startX-2*aDynamites[f].radius&&c<aDynamites[f].startX+2*aDynamites[f].radius&&d>aDynamites[f].startY-2*aDynamites[f].radius&&d<aDynamites[f].startY+2*aDynamites[f].radius){c=500*Math.random()+150,d=200*Math.random()+140,g=!1;break}g=!0}else g=!0;g&&e&&(a=!0),++b>=200&&(a=!0)}return{x:c,y:d}}function ballCallback(a,b){switch("undefined"==typeof b&&(b=null),a){case"exploded":initLevelFail();break;case"moveEnded":for(var c=!0,d=0;d<aBalls.length;d++)if("moving"==aBalls[d].state){c=!1;break}for(var d=0;d<aBalls.length;d++)if("cueBall"==aBalls[d].oData.type&&"holed"==aBalls[d].state)return;if(c){for(var e=!0,d=0;d<aBalls.length;d++)if("waiting"==aBalls[d].state&&"cueBall"!=aBalls[d].oData.type){e=!1;break}if(e)return;gameTouchState=0,aimX=targAimX=cueBall.x,aimY=targAimY=cueBall.y,arrow.renderFunc=arrow.renderAim,oPosData.prevBallX=cueBall.trackX,oPosData.prevBallY=cueBall.trackY,shotsSinceLastPot>0?shotScore=100:shotScore+=50,shotsSinceLastPot++;for(var d=0;d<aBalls.length;d++)if("cueBall"==aBalls[d].oData.type){aBalls[d].changeState("indicating");break}}break;case"holeEnded":for(var d=0;d<aBalls.length;d++)if(aBalls[d].removeMe){aBalls.splice(d,1);break}1==aBalls.length&&(9>levelNum?initLevelComplete():initGameComplete())}}function updateGameEvent(){if(!manualPause&&!rotatePause&&"game"==gameState){var a=getDelta();if(timerRunning&&(timer-=1.1*a),0>timer){for(var b=0;b<aBalls.length;b++)"cueBall"!=aBalls[b].oData.type&&aBalls[b].changeState("explode");for(var b=0;b<aDynamites.length;b++)aDynamites[b].explode();playSound("explode"),gameTouchState=4,timer=0,timerRunning=!1}2==gameTouchState?(aimX+=(targAimX-aimX)/.1*a,aimY+=(targAimY-aimY)/.1*a,oPosData.targStageY=buffer>targAimY&&cueBall.trackY<140?-targAimY:targAimY>canvas.height-buffer&&cueBall.trackY>340?-buffer-(buffer-(canvas.height-targAimY)):-buffer,oPosData.targStageY>0?oPosData.targStageY=0:oPosData.targStageY<-80&&(oPosData.targStageY=-80)):oPosData.targStageY=-buffer,oPosData.stageY+=(oPosData.targStageY-oPosData.stageY)/.3*a,table.update(oPosData.stageX,oPosData.stageY,a),table.render(ctx),3==gameTouchState&&physics2D.update(a);for(var b=0;b<aDynamites.length;b++)aDynamites[b].update(oPosData.stageX,oPosData.stageY,a),renderSprite(aDynamites[b]);for(var b=0;b<aBalls.length;b++){if("moving"==aBalls[b].state){for(var c=0;c<aDynamites.length;c++)timerRunning&&isNearDynamite(aBalls[b],aDynamites[c])&&(aDynamites[c].explode(),playSound("explode"),timerRunning=!1,aBalls.splice(b,1),b>=aBalls.length&&(b=aBalls.length-1));for(var c=0;c<aHoles.length;c++)if(isNearHole(aBalls[b],aHoles[c])){playSound("pot"+Math.ceil(3*Math.random())),aBalls[b].changeState("holed",{x:aHoles[c].x,y:aHoles[c].y,score:aBalls[b].timer}),levelScore+=aBalls[b].timer,hud.score=levelScore;for(var d=!0,e=0;e<aBalls.length;e++)if("cueBall"!=aBalls[e].oData.type&&"holed"!=aBalls[e].state){d=!1;break}d&&(timerRunning=!1);break}}aBalls[b].update(oPosData.stageX,oPosData.stageY,a),aBalls[b].timer=Math.ceil(timer),renderSprite(aBalls[b])}arrow.update(cueBall.x,cueBall.y,aimX,aimY,a),arrow.render(ctx),hud.update(oPosData.stageX,oPosData.stageY,a),hud.render(ctx),renderMuteBut(),requestAnimFrame(updateGameEvent)}}function updateLevelComplete(){if(!rotatePause&&"levelComplete"==gameState){var a=getDelta();background.updateScroll(a),background.renderScroll(ctx),panel.update(a),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateLevelComplete)}}function updateGameComplete(){if(!rotatePause&&"gameComplete"==gameState){var a=getDelta();background.updateScroll(a),background.renderScroll(ctx),panel.update(a),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateGameComplete)}}function updateLevelFail(){if(!rotatePause&&"levelFail"==gameState){var a=getDelta();background.updateScroll(a),background.renderScroll(ctx),panel.update(a),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateLevelFail)}}function updateSplashScreenEvent(){if(!rotatePause&&"splash"==gameState){var a=getDelta();if(splashTimer+=a,splashTimer>2.5)return initStartScreen(),void 0;splash.render(ctx,a),requestAnimFrame(updateSplashScreenEvent)}}function updateStartScreenEvent(){if(!rotatePause&&"start"==gameState){var a=getDelta();background.updateScroll(a),background.renderScroll(ctx),panel.update(a),panel.render(ctx),renderMuteBut(),requestAnimFrame(updateStartScreenEvent)}}function getDelta(){var a=(new Date).getTime(),b=(a-previousTime)/1e3;return previousTime=a,b>.5&&(b=0),b}function renderSprite(a){ctx.save(),ctx.translate(a.x,a.y),ctx.rotate(a.rotation),ctx.globalAlpha=a.alpha,ctx.scale(a.scaleX,a.scaleY),a.render(ctx),ctx.restore()}function checkSpriteCollision(a,b){var c=a.x,d=a.y,e=b.x,f=b.y,g=(c-e)*(c-e)+(d-f)*(d-f),h=a.radius*b.radius;return h>g?!0:!1}function getScaleImageToMax(a,b){var c;return c=a.isSpriteSheet?b[0]/a.oData.spriteWidth<b[1]/a.oData.spriteHeight?Math.min(b[0]/a.oData.spriteWidth,1):Math.min(b[1]/a.oData.spriteHeight,1):b[0]/a.img.width<b[1]/a.img.height?Math.min(b[0]/a.img.width,1):Math.min(b[1]/a.img.height,1)}function getCentreFromTopLeft(a,b,c){var d=new Array;return d.push(a[0]+b.oData.spriteWidth/2*c),d.push(a[1]+b.oData.spriteHeight/2*c),d}function loadPreAssets(){aLangs.length>1?(preAssetLib=new Utils.AssetLoader(curLang,[{id:"langSelect",file:"images/langSelect.jpg"},{id:"preloadImage",file:"images/preloadImage.jpg"}],ctx,canvas.width,canvas.height,!1),preAssetLib.onReady(initLangSelect)):(curLang=aLangs[0],preAssetLib=new Utils.AssetLoader(curLang,[{id:"preloadImage",file:"images/preloadImage.jpg"}],ctx,canvas.width,canvas.height,!1),preAssetLib.onReady(initLoadAssets))}function initLangSelect(){var a=preAssetLib.getData("langSelect");ctx.drawImage(a.img,canvas.width/2-a.img.width/2,canvas.height/2-a.img.height/2);for(var b=140,c=0;c<aLangs.length;c++){var d=canvas.width/2-b*aLangs.length/2+c*b,e=canvas.height/2-b/2;userInput.addHitArea("langSelect",butEventHandler,{lang:aLangs[c]},"rect",{aRect:[d,e,d+b,e+140]})}}function initLoadAssets(){var a=preAssetLib.getData("preloadImage");ctx.drawImage(a.img,0,0),loadAssets()}function loadAssets(){assetLib=new Utils.AssetLoader(curLang,[{id:"rotateDeviceMessage",file:"images/rotateDeviceMessage.jpg"},{id:"splash",file:"images/splashScreen.jpg"},{id:"background",file:"images/background.jpg"},{id:"hud",file:"images/hud.png"},{id:"uiButs",file:"images/"+curLang+"/uiButs_173x96.png"},{id:"panels",file:"images/"+curLang+"/panels_800x400.png"},{id:"potNumbers",file:"images/potNumbers_43x57.png"},{id:"levelNumbers",file:"images/levelNumbers_23x33.png"},{id:"ballNumbers",file:"images/ballNumbers_25x21.png"},{id:"muteBut",file:"images/mute_61x63.png"},{id:"ball",file:"images/balls_156x156.png",oAnims:{cueBallWaiting:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19],cueBallMoving:[19],ballWaiting:[20,21,22],ballMoving:[20,21,22],ballExplode:[23,24,25,26,27,28,29,30,31,32,33]}},{id:"mbAnim",file:"images/mbAnim_367x79.jpg",oAnims:{intro:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56]}},{id:"table1",file:"images/table1.jpg"},{id:"table2",file:"images/table2.jpg"},{id:"arrow",file:"images/arrow_100x32.png"},{id:"cue",file:"images/cue_499x26.png"},{id:"logo",file:"images/logo.png"},{id:"explosion",file:"images/explosion_266x267.png",oAnims:{dynamite:[0],explode:[1,2,3,4,5,6,7,8,9,10,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12]}}],ctx,canvas.width,canvas.height),assetLib.onReady(initSplash)}function resizeCanvas(){var a=window.innerWidth,b=window.innerHeight;a>480&&(a-=1,b-=1),window.innerWidth<window.innerHeight&&isMobile?("loading"!=gameState&&rotatePauseOn(),canvas.style.width=a+"px",canvas.style.height=a/canvas.width*canvas.height+"px",canvasX=0,canvasY=(b-a/canvas.width*canvas.height)/2,canvasScaleX=canvasScaleY=canvas.width/a,div.style.marginTop=canvasY+"px",div.style.marginLeft=canvasX+"px"):isMobile?(rotatePause&&rotatePauseOff(),a/canvas.width<b/canvas.height?(canvas.style.width=a+"px",canvas.style.height=a/canvas.width*canvas.height+"px",canvasX=0,canvasY=(b-a/canvas.width*canvas.height)/2,canvasScaleX=canvasScaleY=canvas.width/a,div.style.marginTop=canvasY+"px",div.style.marginLeft=canvasX+"px"):(canvas.style.width=b/canvas.height*canvas.width+"px",canvas.style.height=b+"px",canvasX=(a-b/canvas.height*canvas.width)/2,canvasY=0,canvasScaleX=canvasScaleY=canvas.height/b,div.style.marginTop=canvasY+"px",div.style.marginLeft=canvasX+"px")):(rotatePause&&rotatePauseOff(),a/canvas.width<b/canvas.height?(canvas.style.width=a+"px",canvas.style.height=a/canvas.width*canvas.height+"px",canvasX=0,canvasY=(b-a/canvas.width*canvas.height)/2,canvasScaleX=canvasScaleY=canvas.width/a,div.style.marginTop=canvasY+"px",div.style.marginLeft=canvasX+"px"):(canvas.style.width=b/canvas.height*canvas.width+"px",canvas.style.height=b+"px",canvasX=(a-b/canvas.height*canvas.width)/2,canvasY=0,canvasScaleX=canvasScaleY=canvas.height/b,div.style.marginTop=canvasY+"px",div.style.marginLeft=canvasX+"px")),userInput.setCanvas(canvasX,canvasY,canvasScaleX,canvasScaleY)}function playSound(a){1==audioType&&sound.play(a)}function toggleMute(){muted=!muted,1==audioType&&(muted?Howler.mute():Howler.unmute()),renderMuteBut()}function renderLogoBut(){ctx.drawImage(oLogoBut.oImgData.img,0,0,oLogoBut.oImgData.img.width,oLogoBut.oImgData.img.height,oLogoBut.aPos[0]-oLogoBut.oImgData.img.width/2*oLogoBut.scale,oLogoBut.aPos[1]-oLogoBut.oImgData.img.height/2*oLogoBut.scale,oLogoBut.oImgData.img.width*oLogoBut.scale,oLogoBut.oImgData.img.height*oLogoBut.scale)}function renderMuteBut(){if(0!=audioType){var a=assetLib.getData("muteBut"),b=0;muted&&(b=1);var c=b*a.oData.spriteWidth%a.img.width,d=Math.floor(b/(a.img.width/a.oData.spriteWidth))*a.oData.spriteHeight;ctx.drawImage(a.img,c,d,a.oData.spriteWidth,a.oData.spriteHeight,742,3,a.oData.spriteWidth,a.oData.spriteHeight)}}function toggleManualPause(){if(manualPause)manualPause=!1,userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("resumeFromPause"),userInput.removeHitArea("replayFromPause"),pauseCoreOff();else{manualPause=!0,pauseCoreOn();var a={oImgData:assetLib.getData("uiButs"),aPos:[225,300],scale:1,frame:3},b={oImgData:assetLib.getData("uiButs"),aPos:[575,300],scale:1,frame:5},c={oImgData:assetLib.getData("uiButs"),aPos:[canvas.width/2,300],scale:1,frame:2},d=new Array(a,b,c);userInput.addHitArea("quitFromPause",butEventHandler,null,"image",a),userInput.addHitArea("resumeFromPause",butEventHandler,null,"image",b),userInput.addHitArea("replayFromPause",butEventHandler,null,"image",c),panel=new Elements.Panel(assetLib.getData("panels"),assetLib.getData("levelNumbers"),"pause",d,canvas.width,canvas.height),panel.render(ctx),userInput.addHitArea("pause",butEventHandler,null,"rect",{aRect:[0,0,55,55]},!0)}}function rotatePauseOn(){rotatePause=!0,ctx.drawImage(assetLib.getImg("rotateDeviceMessage"),0,0),userInput.pauseIsOn=!0,pauseCoreOn()}function rotatePauseOff(){rotatePause=!1,userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("resumeFromPause"),userInput.removeHitArea("replayFromPause"),pauseCoreOff()}function pauseCoreOn(){switch(1==audioType&&Howler.mute(),gameState){case"start":break;case"help":break;case"game":userInput.removeHitArea("gameTouch");break;case"end":}}function pauseCoreOff(){switch(1==audioType&&(muted||Howler.unmute()),previousTime=(new Date).getTime(),userInput.pauseIsOn=!1,gameState){case"splash":updateSplashScreenEvent();break;case"start":initStartScreen();break;case"tutorial":break;case"pauseReplay":break;case"game":manualPause=!1,userInput.addHitArea("gameTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,0,canvas.width,canvas.height]},!0),updateGameEvent();break;case"levelComplete":initLevelComplete();break;case"gameComplete":initGameComplete();break;case"levelFail":initLevelFail()}}var Utils;!function(a){var b=function(){function a(a,b,c,d,e,f){"undefined"==typeof f&&(f=!0),this.oAssetData={},this.assetsLoaded=0,this.totalAssets=b.length,this.ctx=c,this.canvasWidth=d,this.canvasHeight=e,this.showBar=f,this.topLeftX=this.canvasWidth/2-d/4,this.topLeftY=210,this.showBar&&(ctx.strokeStyle="#ffffff",ctx.lineWidth=2,ctx.fillStyle="#FF592E",ctx.moveTo(this.topLeftX,this.topLeftY),ctx.lineTo(this.topLeftX+d/2,this.topLeftY+0),ctx.lineTo(this.topLeftX+d/2,this.topLeftY+20),ctx.lineTo(this.topLeftX+0,this.topLeftY+20),ctx.lineTo(this.topLeftX+0,this.topLeftY+0),ctx.stroke());for(var g=0;g<b.length;g++)this.loadImage(b[g])}return a.prototype.loadImage=function(a){var b=this,c=new Image;c.onload=function(){b.oAssetData[a.id]={},b.oAssetData[a.id].img=c,b.oAssetData[a.id].oData={};var d=b.getSpriteSize(a.file);0!=d[0]?(b.oAssetData[a.id].oData.spriteWidth=d[0],b.oAssetData[a.id].oData.spriteHeight=d[1]):(b.oAssetData[a.id].oData.spriteWidth=b.oAssetData[a.id].img.width,b.oAssetData[a.id].oData.spriteHeight=b.oAssetData[a.id].img.height),a.oAnims&&(b.oAssetData[a.id].oData.oAnims=a.oAnims),++b.assetsLoaded,b.showBar&&ctx.fillRect(b.topLeftX+2,b.topLeftY+2,(b.canvasWidth/2-4)/b.totalAssets*b.assetsLoaded,16),b.checkLoadComplete()},c.src=a.file},a.prototype.getSpriteSize=function(a){for(var b=new Array,c="",d="",e=0,f=a.lastIndexOf("."),g=!0;g;)f--,0==e&&this.isNumber(a.charAt(f))?c=a.charAt(f)+c:0==e&&c.length>0&&"x"==a.charAt(f)?(f--,e=1,d=a.charAt(f)+d):1==e&&this.isNumber(a.charAt(f))?d=a.charAt(f)+d:1==e&&d.length>0&&"_"==a.charAt(f)?(g=!1,b=[parseInt(d),parseInt(c)]):(g=!1,b=[0,0]);return b},a.prototype.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},a.prototype.checkLoadComplete=function(){this.assetsLoaded==this.totalAssets&&this.loadedCallback()},a.prototype.onReady=function(a){this.loadedCallback=a},a.prototype.getImg=function(a){return this.oAssetData[a].img},a.prototype.getData=function(a){return this.oAssetData[a]},a}();a.AssetLoader=b}(Utils||(Utils={}));var Utils;!function(a){var b=function(){function a(a,b,c,d){this.x=0,this.y=0,this.rotation=0,this.radius=10,this.removeMe=!1,this.frameInc=0,this.animType="loop",this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.oImgData=a,this.oAnims=this.oImgData.oData.oAnims,this.fps=b,this.radius=c,this.animId=d}return a.prototype.updateAnimation=function(a){this.frameInc+=this.fps*a},a.prototype.resetAnim=function(){this.frameInc=0,this.oAnims=this.oImgData.oData.oAnims},a.prototype.setFrame=function(a){this.fixedFrame=a},a.prototype.setAnimType=function(a,b,c){switch("undefined"==typeof c&&(c=!0),this.animId=b,this.animType=a,c&&this.resetAnim(),a){case"loop":break;case"once":this.maxIdx=this.oAnims[this.animId].length-1}},a.prototype.render=function(a){if(null!=this.animId){var b=this.oAnims[this.animId].length,c=Math.floor(this.frameInc),d=this.oAnims[this.animId][c%b],e=d*this.oImgData.oData.spriteWidth%this.oImgData.img.width,f=Math.floor(d/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;if("once"==this.animType&&c>this.maxIdx){this.fixedFrame=this.oAnims[this.animId][b-1],this.animId=null,this.animEndedFunc();var e=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,f=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight}}else var e=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,f=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;a.drawImage(this.oImgData.img,e,f,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.oImgData.oData.spriteWidth/2+this.offsetX,-this.oImgData.oData.spriteHeight/2+this.offsetY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight)},a}();a.AnimSprite=b}(Utils||(Utils={}));var Utils;!function(a){var b=function(){function a(a,b,c){"undefined"==typeof c&&(c=0),this.x=0,this.y=0,this.rotation=0,this.radius=10,this.removeMe=!1,this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1,this.oImgData=a,this.radius=b,this.setFrame(c)}return a.prototype.setFrame=function(a){this.frameNum=a},a.prototype.render=function(a){var b=this.frameNum*this.oImgData.oData.spriteWidth%this.oImgData.img.width,c=Math.floor(this.frameNum/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;a.drawImage(this.oImgData.img,b,c,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.oImgData.oData.spriteWidth/2+this.offsetX,-this.oImgData.oData.spriteHeight/2+this.offsetY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight)},a}();a.BasicSprite=b}(Utils||(Utils={}));var Utils;!function(a){var b=function(){function a(a,b){var c=this;this.canvasX=0,this.canvasY=0,this.canvasScaleX=1,this.canvasScaleY=1,this.prevHitTime=0,this.pauseIsOn=!1,this.isDown=!1,this.isDetectingKeys=!1,this.isBugBrowser=b,a.addEventListener("touchstart",function(a){for(var b=0;b<a.changedTouches.length;b++)c.hitDown(a,a.changedTouches[b].pageX,a.changedTouches[b].pageY,a.changedTouches[b].identifier)},!1),a.addEventListener("touchend",function(a){for(var b=0;b<a.changedTouches.length;b++)c.hitUp(a,a.changedTouches[b].pageX,a.changedTouches[b].pageY,a.changedTouches[b].identifier)},!1),a.addEventListener("touchmove",function(a){for(var b=0;b<c.aHitAreas.length;b++)c.move(a,a.changedTouches[b].pageX,a.changedTouches[b].pageY,a.changedTouches[b].identifier,!0)},!1),a.addEventListener("mousedown",function(a){c.isDown=!0,c.hitDown(a,a.pageX,a.pageY,1)},!1),a.addEventListener("mouseup",function(a){c.isDown=!1,c.hitUp(a,a.pageX,a.pageY,1)},!1),a.addEventListener("mousemove",function(a){c.move(a,a.pageX,a.pageY,1,c.isDown)},!1),this.aHitAreas=new Array,this.aKeys=new Array}return a.prototype.setCanvas=function(a,b,c,d){this.canvasX=a,this.canvasY=b,this.canvasScaleX=c,this.canvasScaleY=d},a.prototype.hitDown=function(a,b,c,d){if(!this.pauseIsOn){var e=(new Date).getTime();if(!(e-this.prevHitTime<500&&isBugBrowser)){this.prevHitTime=e,a.preventDefault(),a.stopPropagation(),b=(b-this.canvasX)*this.canvasScaleX,c=(c-this.canvasY)*this.canvasScaleY;for(var f=0;f<this.aHitAreas.length;f++)if(this.aHitAreas[f].rect&&b>this.aHitAreas[f].area[0]&&c>this.aHitAreas[f].area[1]&&b<this.aHitAreas[f].area[2]&&c<this.aHitAreas[f].area[3]){this.aHitAreas[f].aTouchIdentifiers.push(d),this.aHitAreas[f].oData.hasLeft=!1,this.aHitAreas[f].oData.isDown||(this.aHitAreas[f].oData.isDown=!0,this.aHitAreas[f].oData.x=b,this.aHitAreas[f].oData.y=c,this.aHitAreas[f].callback(this.aHitAreas[f].id,this.aHitAreas[f].oData));break}}}},a.prototype.hitUp=function(a,b,c,d){if(!this.pauseIsOn){a.preventDefault(),a.stopPropagation(),b=(b-this.canvasX)*this.canvasScaleX,c=(c-this.canvasY)*this.canvasScaleY;for(var e=0;e<this.aHitAreas.length;e++)if(this.aHitAreas[e].rect&&b>this.aHitAreas[e].area[0]&&c>this.aHitAreas[e].area[1]&&b<this.aHitAreas[e].area[2]&&c<this.aHitAreas[e].area[3]){for(var f=0;f<this.aHitAreas[e].aTouchIdentifiers.length;f++)this.aHitAreas[e].aTouchIdentifiers[f]==d&&(this.aHitAreas[e].aTouchIdentifiers.splice(f,1),f-=1);0==this.aHitAreas[e].aTouchIdentifiers.length&&(this.aHitAreas[e].oData.isDown=!1,this.aHitAreas[e].oData.multiTouch&&this.aHitAreas[e].callback(this.aHitAreas[e].id,this.aHitAreas[e].oData));
break}}},a.prototype.move=function(a,b,c,d,e){if(!this.pauseIsOn&&e){b=(b-this.canvasX)*this.canvasScaleX,c=(c-this.canvasY)*this.canvasScaleY;for(var f=0;f<this.aHitAreas.length;f++)if(this.aHitAreas[f].rect)if(b>this.aHitAreas[f].area[0]&&c>this.aHitAreas[f].area[1]&&b<this.aHitAreas[f].area[2]&&c<this.aHitAreas[f].area[3])this.aHitAreas[f].oData.hasLeft=!1,this.aHitAreas[f].oData.isDown||(this.aHitAreas[f].oData.isDown=!0,this.aHitAreas[f].oData.x=b,this.aHitAreas[f].oData.y=c,this.aHitAreas[f].aTouchIdentifiers.push(d),this.aHitAreas[f].oData.multiTouch&&this.aHitAreas[f].callback(this.aHitAreas[f].id,this.aHitAreas[f].oData)),this.aHitAreas[f].oData.isDraggable&&(this.aHitAreas[f].oData.isBeingDragged=!0,this.aHitAreas[f].oData.x=b,this.aHitAreas[f].oData.y=c,this.aHitAreas[f].callback(this.aHitAreas[f].id,this.aHitAreas[f].oData),this.aHitAreas[f].oData.isBeingDragged=!1);else if(this.aHitAreas[f].oData.isDown&&!this.aHitAreas[f].oData.hasLeft){for(var g=0;g<this.aHitAreas[f].aTouchIdentifiers.length;g++)this.aHitAreas[f].aTouchIdentifiers[g]==d&&(this.aHitAreas[f].aTouchIdentifiers.splice(g,1),g-=1);0==this.aHitAreas[f].aTouchIdentifiers.length&&(this.aHitAreas[f].oData.hasLeft=!0,this.aHitAreas[f].oData.multiTouch&&this.aHitAreas[f].callback(this.aHitAreas[f].id,this.aHitAreas[f].oData))}}},a.prototype.keyDown=function(a){for(var b=0;b<this.aKeys.length;b++)a.keyCode==this.aKeys[b].keyCode&&(this.aKeys[b].oData.isDown=!0,this.aKeys[b].callback(this.aKeys[b].id,this.aKeys[b].oData))},a.prototype.keyUp=function(a){for(var b=0;b<this.aKeys.length;b++)a.keyCode==this.aKeys[b].keyCode&&(this.aKeys[b].oData.isDown=!1,this.aKeys[b].callback(this.aKeys[b].id,this.aKeys[b].oData))},a.prototype.addKey=function(a,b,c,d){var e=this;this.isDetectingKeys||(window.addEventListener("keydown",function(a){e.keyDown(a)},!1),window.addEventListener("keyup",function(a){e.keyUp(a)},!1),this.isDetectingKeys=!0),null==c&&(c=new Object),this.aKeys.push({id:a,callback:b,oData:c,keyCode:d})},a.prototype.removeKey=function(a){for(var b=0;b<this.aKeys.length;b++)this.aKeys[b].id==a&&(this.aKeys.splice(b,1),b-=1)},a.prototype.addHitArea=function(a,b,c,d,e,f){"undefined"==typeof f&&(f=!1),null==c&&(c=new Object),f&&this.removeHitArea(a);var g=new Array;switch(d){case"image":var h;h=new Array(e.aPos[0]-e.oImgData.oData.spriteWidth/2*e.scale,e.aPos[1]-e.oImgData.oData.spriteHeight/2*e.scale,e.aPos[0]+e.oImgData.oData.spriteWidth/2*e.scale,e.aPos[1]+e.oImgData.oData.spriteHeight/2*e.scale),this.aHitAreas.push({id:a,aTouchIdentifiers:g,callback:b,oData:c,rect:!0,area:h});break;case"rect":this.aHitAreas.push({id:a,aTouchIdentifiers:g,callback:b,oData:c,rect:!0,area:e.aRect})}},a.prototype.removeHitArea=function(a){for(var b=0;b<this.aHitAreas.length;b++)this.aHitAreas[b].id==a&&(this.aHitAreas.splice(b,1),b-=1)},a}();a.UserInput=b}(Utils||(Utils={}));var Utils;!function(a){var b=function(){function a(a){this.updateFreq=10,this.updateInc=0,this.frameAverage=0,this.display=1,this.log="",this.render=function(a){this.frameAverage+=this.delta/this.updateFreq,++this.updateInc>=this.updateFreq&&(this.updateInc=0,this.display=this.frameAverage,this.frameAverage=0),a.textAlign="left",ctx.font="10px Helvetica",a.fillStyle="#333333",a.beginPath(),a.rect(0,this.canvasHeight-15,40,15),a.closePath(),a.fill(),a.fillStyle="#ffffff",a.fillText(Math.round(1e3/(1e3*this.display))+" fps "+this.log,5,this.canvasHeight-5)},this.canvasHeight=a}return a.prototype.update=function(a){this.delta=a},a}();a.FpsMeter=b}(Utils||(Utils={}));var Elements;!function(a){var b=function(){function a(a,b,c){this.x=0,this.y=0,this.targY=0,this.incY=0,this.posY=0,this.oImgData=a,this.canvasWidth=b,this.canvasHeight=c}return a.prototype.updateScroll=function(a){this.incY+=5*a,this.posY-=8*this.posY*a},a.prototype.renderScroll=function(a){var b=40;a.drawImage(this.oImgData.img,0,0);for(var c=0;b>c;c++)a.drawImage(this.oImgData.img,c*(this.canvasWidth/b),0,this.canvasWidth/b,this.canvasHeight,c*(this.canvasWidth/b),2*Math.sin(this.incY+c/5)-this.posY,this.canvasWidth/b,this.canvasHeight)},a.prototype.render=function(a){a.drawImage(this.oImgData.img,0,0)},a}();a.Background=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(){function a(a,b,c,d){this.inc=0,this.frameInc=0,this.oSplashScreenImgData=a,this.oAnimImgData=b,this.canvasWidth=c,this.canvasHeight=d,this.maxIdx=this.oAnimImgData.oData.oAnims.intro.length-1}return a.prototype.render=function(a,b){a.drawImage(this.oSplashScreenImgData.img,0,0),this.frameInc+=30*b;var c=this.oAnimImgData.oData.oAnims.intro.length,d=Math.floor(this.frameInc),e=this.oAnimImgData.oData.oAnims.intro[d%c];d>this.maxIdx&&(e=this.oAnimImgData.oData.oAnims.intro[c-1]);var f=e*this.oAnimImgData.oData.spriteWidth%this.oAnimImgData.img.width,g=Math.floor(e/(this.oAnimImgData.img.width/this.oAnimImgData.oData.spriteWidth))*this.oAnimImgData.oData.spriteHeight;a.drawImage(this.oAnimImgData.img,f,g,this.oAnimImgData.oData.spriteWidth,this.oAnimImgData.oData.spriteHeight,this.canvasWidth/2-this.oAnimImgData.oData.spriteWidth/2-50,this.canvasHeight/2-this.oAnimImgData.oData.spriteHeight/2-20,this.oAnimImgData.oData.spriteWidth,this.oAnimImgData.oData.spriteHeight)},a}();a.Splash=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(){function a(a,b,c,d,e,f){this.timer=.3,this.endTime=0,this.posY=0,this.numberSpace=13,this.potNumberSpace=35,this.incY=0,this.oPanelsImgData=a,this.oNumbersImgData=b,this.panelType=c,this.aButs=d,this.canvasWidth=e,this.canvasHeight=f}return a.prototype.update=function(a){this.incY+=5*a},a.prototype.startTween1=function(){this.posY=800,TweenLite.to(this,.8,{posY:0,ease:"Back.easeOut"})},a.prototype.startTween2=function(){this.posY=800,TweenLite.to(this,.5,{posY:0,ease:"Quad.easeOut"})},a.prototype.startTweenEndLevel=function(){this.aStarPos=new Array;for(var a=0;a<this.oScoreData.stars;a++)this.aStarPos.push({posY:-400,scaleY:2}),TweenLite.to(this.aStarPos[a],1.5,{posY:0,scaleY:1,ease:"Bounce.easeOut",delay:.3*a});this.posY=800,TweenLite.to(this,.8,{posY:0,ease:"Back.easeOut"})},a.prototype.render=function(a){switch(this.panelType){case"start":var b=0,c=b*this.oPanelsImgData.oData.spriteWidth%this.oPanelsImgData.img.width,d=Math.floor(b/(this.oPanelsImgData.img.width/this.oPanelsImgData.oData.spriteWidth))*this.oPanelsImgData.oData.spriteHeight;a.drawImage(this.oPanelsImgData.img,c,d,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight,0,0+this.posY,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight);break;case"levelComplete":var b=1,c=b*this.oPanelsImgData.oData.spriteWidth%this.oPanelsImgData.img.width,d=Math.floor(b/(this.oPanelsImgData.img.width/this.oPanelsImgData.oData.spriteWidth))*this.oPanelsImgData.oData.spriteHeight;a.drawImage(this.oPanelsImgData.img,c,d,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight,0,0+this.posY,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight);for(var e=this.oScoreData.levelScore,f=0;f<e.toString().length;f++){b=parseFloat(e.toString().charAt(f));var c=b*this.oNumbersImgData.oData.spriteWidth%this.oNumbersImgData.img.width,d=Math.floor(b/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight;a.drawImage(this.oNumbersImgData.img,c,d,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,290+f*this.potNumberSpace-this.potNumberSpace*e.toString().length/2,190+this.posY,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight)}for(var e=this.oScoreData.totalScore,f=0;f<e.toString().length;f++){b=parseFloat(e.toString().charAt(f));var c=b*this.oNumbersImgData.oData.spriteWidth%this.oNumbersImgData.img.width,d=Math.floor(b/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight;a.drawImage(this.oNumbersImgData.img,c,d,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,510+f*this.potNumberSpace-this.potNumberSpace*e.toString().length/2,190+this.posY,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight)}break;case"gameComplete":var b=3,c=b*this.oPanelsImgData.oData.spriteWidth%this.oPanelsImgData.img.width,d=Math.floor(b/(this.oPanelsImgData.img.width/this.oPanelsImgData.oData.spriteWidth))*this.oPanelsImgData.oData.spriteHeight;a.drawImage(this.oPanelsImgData.img,c,d,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight,0,0+this.posY,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight);for(var e=this.oScoreData.levelScore,f=0;f<e.toString().length;f++){b=parseFloat(e.toString().charAt(f));var c=b*this.oNumbersImgData.oData.spriteWidth%this.oNumbersImgData.img.width,d=Math.floor(b/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight;a.drawImage(this.oNumbersImgData.img,c,d,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,290+f*this.potNumberSpace-this.potNumberSpace*e.toString().length/2,190+this.posY,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight)}for(var e=this.oScoreData.totalScore,f=0;f<e.toString().length;f++){b=parseFloat(e.toString().charAt(f));var c=b*this.oNumbersImgData.oData.spriteWidth%this.oNumbersImgData.img.width,d=Math.floor(b/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight;a.drawImage(this.oNumbersImgData.img,c,d,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,510+f*this.potNumberSpace-this.potNumberSpace*e.toString().length/2,190+this.posY,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight)}break;case"levelFail":var b=2,c=b*this.oPanelsImgData.oData.spriteWidth%this.oPanelsImgData.img.width,d=Math.floor(b/(this.oPanelsImgData.img.width/this.oPanelsImgData.oData.spriteWidth))*this.oPanelsImgData.oData.spriteHeight;a.drawImage(this.oPanelsImgData.img,c,d,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight,0,0+this.posY,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight);for(var e=this.oScoreData.totalScore,f=0;f<e.toString().length;f++){b=parseFloat(e.toString().charAt(f));var c=b*this.oNumbersImgData.oData.spriteWidth%this.oNumbersImgData.img.width,d=Math.floor(b/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight;a.drawImage(this.oNumbersImgData.img,c,d,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,this.canvasWidth/2+f*this.potNumberSpace-this.potNumberSpace*e.toString().length/2,190+this.posY,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight)}break;case"tutorial0":case"tutorial1":case"tutorial2":case"tutorial3":case"tutorial4":var b=parseFloat(this.panelType.charAt(this.panelType.length-1))+5,c=b*this.oPanelsImgData.oData.spriteWidth%this.oPanelsImgData.img.width,d=Math.floor(b/(this.oPanelsImgData.img.width/this.oPanelsImgData.oData.spriteWidth))*this.oPanelsImgData.oData.spriteHeight;a.drawImage(this.oPanelsImgData.img,c,d,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight,0,0+this.posY,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight);break;case"pause":var b=4,c=b*this.oPanelsImgData.oData.spriteWidth%this.oPanelsImgData.img.width,d=Math.floor(b/(this.oPanelsImgData.img.width/this.oPanelsImgData.oData.spriteWidth))*this.oPanelsImgData.oData.spriteHeight;a.drawImage(this.oPanelsImgData.img,c,d,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight,0,0,this.oPanelsImgData.oData.spriteWidth,this.oPanelsImgData.oData.spriteHeight)}for(var f=0;f<this.aButs.length;f++){var g=this.posY,h=0;this.aButs[f].isStill||0==this.incY||(h=3*Math.sin(this.incY+45*f));var b=this.aButs[f].frame,c=b*this.aButs[f].oImgData.oData.spriteWidth%this.aButs[f].oImgData.img.width,d=Math.floor(b/(this.aButs[f].oImgData.img.width/this.aButs[f].oImgData.oData.spriteWidth))*this.aButs[f].oImgData.oData.spriteHeight;a.drawImage(this.aButs[f].oImgData.img,c,d,this.aButs[f].oImgData.oData.spriteWidth,this.aButs[f].oImgData.oData.spriteHeight,this.aButs[f].aPos[0]-this.aButs[f].oImgData.oData.spriteWidth/2+g,this.aButs[f].aPos[1]-this.aButs[f].oImgData.oData.spriteHeight/2-h,this.aButs[f].oImgData.oData.spriteWidth*this.aButs[f].scale,this.aButs[f].oImgData.oData.spriteHeight*this.aButs[f].scale)}},a}();a.Panel=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(){function a(a,b,c,d,e,f){this.x=0,this.y=0,this.score=0,this.letterSpace=13,this.oHudImgData=a,this.oNumbersImgData=b,this.canvasWidth=c,this.canvasHeight=d,this.levelNum=f+1,this.score=e}return a.prototype.update=function(a,b){this.x=a,this.y=b},a.prototype.render=function(a){a.drawImage(this.oHudImgData.img,0,0);for(var b=0;b<this.score.toString().length;b++){var c=parseFloat(this.score.toString().charAt(b)),d=c*this.oNumbersImgData.oData.spriteWidth%this.oNumbersImgData.img.width,e=Math.floor(c/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight;a.drawImage(this.oNumbersImgData.img,d,e,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,545+b*this.letterSpace,49+this.y,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight)}for(var b=0;b<this.levelNum.toString().length;b++){var c=parseFloat(this.levelNum.toString().charAt(b)),d=c*this.oNumbersImgData.oData.spriteWidth%this.oNumbersImgData.img.width,e=Math.floor(c/(this.oNumbersImgData.img.width/this.oNumbersImgData.oData.spriteWidth))*this.oNumbersImgData.oData.spriteHeight;a.drawImage(this.oNumbersImgData.img,d,e,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight,255+b*this.letterSpace,49+this.y,this.oNumbersImgData.oData.spriteWidth,this.oNumbersImgData.oData.spriteHeight)}},a.prototype.updateScore=function(a,b){this.score=b},a}();a.Hud=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(){function a(a,b,c){this.radian=Math.PI/180,this.oLevelImgData=a,this.canvasWidth=b,this.canvasHeight=c}return a.prototype.update=function(a,b){this.x=a,this.y=b},a.prototype.render=function(a){a.drawImage(this.oLevelImgData.img,-this.x,-this.y,this.canvasWidth,this.canvasHeight,0,0,this.canvasWidth,this.canvasHeight)},a}();a.Table=b}(Elements||(Elements={}));var __extends=this.__extends||function(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c},Elements;!function(a){var b=function(a){function b(b,c,d,e,f,g,h,i){a.call(this,b,20,26,f.type+"Waiting"),this.radian=Math.PI/180,this.angle=0,this.inc=0,this.ballRadius=16,this.timer=99,this.vx=0,this.vy=0,this.m=1,this.f=1,this.b=1,"dynamite"==f.type&&(this.ballRadius=35),this.oExplodeImgData=c,this.oPotNumbersImgData=e,this.oBallNumbersImgData=d,this.oData=f,this.ballCallback=g,this.trackX=this.startX=this.oData.x,this.trackY=this.startY=this.oData.y,this.p0={x:this.trackX,y:this.trackY},this.p1={x:this.trackX,y:this.trackY},this.canvasWidth=h,this.canvasHeight=i,this.renderFunc=this.renderBall,this.changeState("waiting")}return __extends(b,a),b.prototype.changeState=function(a,b){switch("undefined"==typeof b&&(b=null),"explode"==this.state,a){case"reset":this.state="reset",this.updateFunc=this.updateWaiting,this.trackX=b.x,this.trackY=b.y,this.p0={x:this.trackX,y:this.trackY},this.p1={x:this.trackX,y:this.trackY},this.scaleX=this.scaleY=1;break;case"waiting":this.state="waiting",this.updateFunc=this.updateWaiting;break;case"indicating":this.state="indicating",this.setAnimType("loop",this.oData.type+"Waiting");break;case"aiming":this.state="aiming",this.updateFunc=this.updateWaiting,this.setAnimType("loop",this.oData.type+"Moving");break;case"moving":this.state="moving",this.vx=b.power/15*Math.cos(b.angle),this.vy=b.power/15*Math.sin(b.angle),this.vz=1,this.dec=1,this.setAnimType("loop",this.oData.type+"Moving"),this.p0={x:this.trackX,y:this.trackY},this.p1={x:this.trackX,y:this.trackY},this.updateFunc=this.updateMoving;break;case"rebound":this.state="moving",this.vz=1,this.dec=1,this.setAnimType("loop",this.oData.type+"Moving"),this.p0={x:this.trackX,y:this.trackY},this.p1={x:this.trackX,y:this.trackY},this.updateFunc=this.updateMoving;break;case"holed":this.oData.score=b.score,this.state="holed",this.trackX=b.x,this.trackY=b.y,"cueBall"!=this.oData.type?(this.setAnimType("once","ballExplode"),this.animEndedFunc=function(){this.ballHoled()},this.updateFunc=this.updateWaiting,this.renderFunc=this.renderHoling):(this.oImgData=this.oExplodeImgData,this.resetAnim(),this.setAnimType("once","explode"),playSound("explode"),this.animEndedFunc=function(){this.ballExploded()},this.updateFunc=this.updateWaiting,this.renderFunc=this.renderHoling);break;case"scoring1":this.state="holed",this.scaleX=this.scaleY=1,this.scoreX=this.x,this.scoreY=this.y-this.oPotNumbersImgData.oData.spriteHeight/2,this.alpha=1,this.x=this.y=0,this.scoreScale=.5,playSound("score"),TweenLite.to(this,1,{scoreY:this.scoreY-5,scoreScale:1,ease:"Back.easeOut",onComplete:this.scoreEnded1,onCompleteParams:[this]}),this.updateFunc=this.updateScoring,this.renderFunc=this.renderScoring;break;case"scoring2":this.state="holed",this.scoreScale=1,TweenLite.to(this,.5,{scoreX:this.canvasWidth+100,scoreScale:2,ease:"Back.easeIn",onComplete:this.scoreEnded2,onCompleteParams:[this]});break;case"explode":if("holed"==this.state)break;this.state="explode",this.oImgData=this.oExplodeImgData,this.resetAnim(),this.setAnimType("once","explode"),this.animEndedFunc=function(){this.ballExploded()},this.updateFunc=this.updateExploding,this.renderFunc=this.renderHoling}},b.prototype.moveEnded=function(a){a.changeState("waiting"),a.ballCallback("moveEnded",{ball:a})},b.prototype.ballExploded=function(a){"undefined"==typeof a&&(a=this),a.ballCallback("exploded",{ball:a})},b.prototype.ballHoled=function(a){"undefined"==typeof a&&(a=this),a.ballCallback("moveEnded",{ball:a}),"cueBall"!=a.oData.type&&a.changeState("scoring1")},b.prototype.scoreEnded1=function(a){a.changeState("scoring2")},b.prototype.scoreEnded2=function(a){a.removeMe=!0,a.ballCallback("holeEnded")},b.prototype.update=function(a,b,c){this.updateFunc(a,b,c)},b.prototype.updateMoving=function(b,c,d){a.prototype.updateAnimation.call(this,d),this.vx*=.985,this.vy*=.985,Math.abs(this.vx)<.05&&Math.abs(this.vy)<.05&&this.moveEnded(this),this.x=this.trackX+b,this.y=this.trackY+c},b.prototype.updateScoring=function(){},b.prototype.updateExploding=function(b,c,d){a.prototype.updateAnimation.call(this,d)},b.prototype.updateWaiting=function(b,c,d){a.prototype.updateAnimation.call(this,d),this.x=this.trackX+b,this.y=this.trackY+c},b.prototype.render=function(a){this.renderFunc(a)},b.prototype.renderHoling=function(b){a.prototype.render.call(this,b)},b.prototype.renderBall=function(b){if(a.prototype.render.call(this,b),"ball"==this.oData.type){var c=this.timer*this.oBallNumbersImgData.oData.spriteWidth%this.oBallNumbersImgData.img.width,d=Math.floor(this.timer/(this.oBallNumbersImgData.img.width/this.oBallNumbersImgData.oData.spriteWidth))*this.oBallNumbersImgData.oData.spriteHeight;b.drawImage(this.oBallNumbersImgData.img,c,d,this.oBallNumbersImgData.oData.spriteWidth,this.oBallNumbersImgData.oData.spriteHeight,-this.oBallNumbersImgData.oData.spriteWidth/2,-this.oBallNumbersImgData.oData.spriteHeight/2,this.oBallNumbersImgData.oData.spriteWidth,this.oBallNumbersImgData.oData.spriteHeight)}},b.prototype.renderScoring=function(a){for(var b=this.oData.score,c=0;c<b.toString().length;c++){var d=parseFloat(b.toString().charAt(c)),e=d*this.oPotNumbersImgData.oData.spriteWidth%this.oPotNumbersImgData.img.width,f=Math.floor(d/(this.oPotNumbersImgData.img.width/this.oPotNumbersImgData.oData.spriteWidth))*this.oPotNumbersImgData.oData.spriteHeight;a.drawImage(this.oPotNumbersImgData.img,e,f,this.oPotNumbersImgData.oData.spriteWidth,this.oPotNumbersImgData.oData.spriteHeight,this.scoreX+35*c-35*b.toString().length/2,this.scoreY,this.oPotNumbersImgData.oData.spriteWidth*this.scoreScale,this.oPotNumbersImgData.oData.spriteHeight/this.scoreScale)}},b.prototype.destroy=function(){TweenLite.killTweensOf(this)},b}(Utils.AnimSprite);a.Ball=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(){function a(a,b,c,d){this.x=0,this.y=0,this.scaleX=0,this.scaleY=1,this.alpha=1,this.maxLength=100,this.oArrowImgData=a,this.oCueImgData=b,this.canvasWidth=c,this.canvasHeight=d,this.renderFunc=this.renderAim}return a.prototype.takeShot=function(a){this.renderFunc=this.renderShot,this.shotHyp=this.hyp,this.shotRot=this.rotation,this.tween=TweenLite.to(this,.15,{shotHyp:0,ease:"Quad.easeIn",onComplete:this.shotEnded,onCompleteParams:[this,a]})},a.prototype.shotEnded=function(a,b){b.changeState("moving",{power:a.hyp,angle:a.shotRot})},a.prototype.update=function(a,b,c,d){this.x=a,this.y=b,this.lengthX=this.x-c,this.lengthY=this.y-d,this.hyp=Math.min(Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY),this.maxLength),this.scaleX=Math.min(this.hyp/this.maxLength,1),this.rotation=Math.atan2(this.lengthY,this.lengthX)},a.prototype.render=function(a){this.renderFunc(a)},a.prototype.renderAim=function(a){if(!(this.scaleX<.1)){a.save(),a.translate(this.x,this.y),a.rotate(this.rotation),a.scale(2*this.scaleX,this.scaleY);var b=0*this.oArrowImgData.oData.spriteWidth%this.oArrowImgData.img.width,c=Math.floor(0/(this.oArrowImgData.img.width/this.oArrowImgData.oData.spriteWidth))*this.oArrowImgData.oData.spriteHeight;a.drawImage(this.oArrowImgData.img,b,c,this.oArrowImgData.oData.spriteWidth,this.oArrowImgData.oData.spriteHeight,0,-this.oArrowImgData.oData.spriteHeight/2,this.oArrowImgData.oData.spriteWidth,this.oArrowImgData.oData.spriteHeight),a.restore(),a.save(),a.translate(this.x,this.y),a.globalAlpha=this.alpha,a.rotate(this.rotation);var b=1*this.oArrowImgData.oData.spriteWidth%this.oArrowImgData.img.width,c=Math.floor(1/(this.oArrowImgData.img.width/this.oArrowImgData.oData.spriteWidth))*this.oArrowImgData.oData.spriteHeight;a.drawImage(this.oArrowImgData.img,b,c,this.oArrowImgData.oData.spriteWidth,this.oArrowImgData.oData.spriteHeight,-this.hyp-16,-this.oArrowImgData.oData.spriteHeight/2,this.oArrowImgData.oData.spriteWidth*this.scaleX,this.oArrowImgData.oData.spriteHeight),a.restore(),a.save(),a.globalAlpha=this.alpha,a.translate(this.x,this.y),a.rotate(this.rotation);var b=1*this.oArrowImgData.oData.spriteWidth%this.oArrowImgData.img.width,c=Math.floor(1/(this.oArrowImgData.img.width/this.oArrowImgData.oData.spriteWidth))*this.oArrowImgData.oData.spriteHeight;a.drawImage(this.oCueImgData.img,0,0,this.oCueImgData.oData.spriteWidth,this.oCueImgData.oData.spriteHeight,-this.hyp-this.oCueImgData.oData.spriteWidth-5,-this.oCueImgData.oData.spriteHeight/2,this.oCueImgData.oData.spriteWidth,this.oCueImgData.oData.spriteHeight),a.restore()}},a.prototype.renderShot=function(a){0!=this.shotHyp&&(a.save(),a.translate(this.x,this.y),a.rotate(this.rotation),a.drawImage(this.oCueImgData.img,0,0,this.oCueImgData.oData.spriteWidth,this.oCueImgData.oData.spriteHeight,-this.shotHyp-this.oCueImgData.oData.spriteWidth-5,-this.oCueImgData.oData.spriteHeight/2,this.oCueImgData.oData.spriteWidth,this.oCueImgData.oData.spriteHeight),a.restore())},a}();a.Arrow=b}(Elements||(Elements={}));var Elements;!function(a){var b=function(a){function b(b,c,d,e,f){a.call(this,b,24,30,"dynamite"),this.startX=0,this.startY=0,this.trackX=0,this.trackY=0,this.oData=d,this.callback=c,this.trackX=this.startX=this.oData.x,this.trackY=this.startY=this.oData.y,this.canvasWidth=e,this.canvasHeight=f}return __extends(b,a),b.prototype.explode=function(){this.setAnimType("once","explode"),this.animEndedFunc=function(){this.explodeComplete()}},b.prototype.explodeComplete=function(a){"undefined"==typeof a&&(a=this),a.callback("exploded")},b.prototype.update=function(b,c,d){a.prototype.updateAnimation.call(this,d),this.x=this.trackX+b,this.y=this.trackY+c},b}(Utils.AnimSprite);a.Dynamite=b}(Elements||(Elements={}));var Utils;!function(a){var b=function(){function a(a,b){this.aLines=new Array,this.aBalls=new Array,this.aLines=a,this.aBalls=b;for(var c=0;c<this.aLines.length;c++)this.updateVector(this.aLines[c],null,!0)}return a.prototype.drawAll=function(a){for(var b=0;b<this.aBalls.length;b++)if("moving"==this.aBalls[b].state){var c=this.aBalls[b];c.trackX=c.p1.x,c.trackY=c.p1.y,c.p0=c.p1,this.updateVector(c,a)}},a.prototype.update=function(a){var b;for(b=0;b<this.aBalls.length;b++){var c=this.aBalls[b];if("moving"==c.state){this.updateVector(c,a);for(var d=0;d<this.aLines.length;d++){this.fi=this.findIntersection(c,this.aLines[d]),this.updateVector(this.fi,a,!1);var e=c.radius-this.fi.len;if(e>=0){playSound("bumper"+Math.ceil(2*Math.random())),c.p1.x+=this.fi.dx*e,c.p1.y+=this.fi.dy*e;var f={dx:this.fi.lx,dy:this.fi.ly,lx:this.fi.dx,ly:this.fi.dy,b:1,f:1},g=this.bounce(c,f);c.vx=g.vx,c.vy=g.vy}}for(var h=0;h<this.aBalls.length;h++)if(b!=h&&"holed"!=this.aBalls[h].state){var i=this.aBalls[h];this.vc={},this.vc.p0=c.p0,this.vc.p1=i.p0,this.updateVector(this.vc,a,!0);var j=c.ballRadius+i.ballRadius,k=j-this.vc.len;if(k>=0){c.p1.x-=this.vc.dx*k,c.p1.y-=this.vc.dy*k;var l=this.bounceBalls(c,i,this.vc);c.vx=l.vx1,c.vy=l.vy1,i.vx=l.vx2,i.vy=l.vy2,c.changeState("rebound"),i.changeState("rebound"),playSound("ballHit"+Math.ceil(3*Math.random()))}else if(k>=-50){this.v3=new Object,this.v3.p0=c.p0,this.v3.p1={x:0,y:0},this.v3.vx=c.vx-i.vx,this.v3.vy=c.vy-i.vy,this.updateVector(this.v3,a);var m=this.projectVector(this.vc,this.v3.dx,this.v3.dy);this.vn={};var n={x:c.p0.x+m.vx,y:c.p0.y+m.vy};this.vn.p0=n,this.vn.p1=i.p0,this.updateVector(this.vn,a,!0);var o=j-this.vn.len;if(o>0){var p=Math.sqrt(j*j-this.vn.len*this.vn.len);if(this.p3={x:this.vn.p0.x-p*this.v3.dx,y:this.vn.p0.y-p*this.v3.dy},this.v4={p0:c.p0,p1:this.p3},this.updateVector(this.v4,a,!0),this.v4.len<=this.v3.len&&this.dotP(this.v4,c)>0){var q=this.v4.len/this.v3.len;c.p1={x:c.p0.x+q*c.vx,y:c.p0.y+q*c.vy},i.p1={x:i.p0.x+q*i.vx,y:i.p0.y+q*i.vy},this.vc={p0:c.p1,p1:i.p1},this.updateVector(this.vc,a,!0),l=this.bounceBalls(c,i,this.vc),c.vx=l.vx1,c.vy=l.vy1,i.vx=l.vx2,i.vy=l.vy2,this.makeVector(i),this.makeVector(c),c.changeState("rebound"),i.changeState("rebound"),playSound("ballHit"+Math.ceil(3*Math.random()))}}}}}}this.drawAll(a)},a.prototype.updateVector=function(a,b,c){"undefined"==typeof c&&(c=!1),b=.0167,1==c?(a.vx=a.p1.x-a.p0.x,a.vy=a.p1.y-a.p0.y):(a.p1.x=a.p0.x+60*a.vx*b,a.p1.y=a.p0.y+60*a.vy*b),this.makeVector(a)},a.prototype.makeVector=function(a){a.len=Math.sqrt(a.vx*a.vx+a.vy*a.vy),a.len>0?(a.dx=a.vx/a.len,a.dy=a.vy/a.len):(a.dx=0,a.dy=0),a.rx=-a.dy,a.ry=a.dx,a.lx=a.dy,a.ly=-a.dx},a.prototype.dotP=function(a,b){var c=a.vx*b.vx+a.vy*b.vy;return c},a.prototype.projectVector=function(a,b,c){var d=a.vx*b+a.vy*c,e={};return e.vx=d*b,e.vy=d*c,e},a.prototype.bounceBalls=function(a,b,c){var d=this.projectVector(a,c.dx,c.dy),e=this.projectVector(a,c.lx,c.ly),f=this.projectVector(b,c.dx,c.dy),g=this.projectVector(b,c.lx,c.ly),h=a.m*d.vx+b.m*f.vx,i=d.vx-f.vx,j=(h+i*a.m)/(a.m+b.m),k=j-i;h=a.m*d.vy+b.m*f.vy,i=d.vy-f.vy;var l=(h+i*a.m)/(a.m+b.m),m=l-i,n={};return n.vx1=e.vx+k,n.vy1=e.vy+m,n.vx2=g.vx+j,n.vy2=g.vy+l,n},a.prototype.bounce=function(a,b){var c=this.projectVector(a,b.dx,b.dy),d=this.projectVector(a,b.lx,b.ly),e={};return d.len=Math.sqrt(d.vx*d.vx+d.vy*d.vy),d.vx=b.lx*d.len,d.vy=b.ly*d.len,e.vx=a.f*b.f*c.vx+a.b*b.b*d.vx,e.vy=a.f*b.f*c.vy+a.b*b.b*d.vy,e},a.prototype.findIntersection=function(a,b){var c={},d={};d.vx=a.p1.x-b.p0.x,d.vy=a.p1.y-b.p0.y;var e=d.vx*b.dx+d.vy*b.dy;if(0>e)c=d;else{var f={};f.vx=a.p1.x-b.p1.x,f.vy=a.p1.y-b.p1.y,e=f.vx*b.dx+f.vy*b.dy,c=e>0?f:this.projectVector(d,b.lx,b.ly)}return c.p0={x:0,y:0},c.p1={x:0,y:0},c},a}();a.Physics2D=b}(Utils||(Utils={}));var Utils;!function(a){var b=function(){function a(a,b){this.saveDataId=a,this.totalLevels=b,this.clearData(),this.setInitialData()}return a.prototype.clearData=function(){this.aLevelStore=new Array,this.aLevelStore.push(0),this.aLevelStore.push(0);for(var a=0;a<this.totalLevels-1;a++)this.aLevelStore.push(1),this.aLevelStore.push(0)},a.prototype.setInitialData=function(){if("undefined"!=typeof Storage)if(null!=localStorage.getItem(this.saveDataId)){this.aLevelStore=localStorage.getItem(this.saveDataId).split(",");for(var a in this.aLevelStore)this.aLevelStore[a]=parseInt(this.aLevelStore[a])}else this.saveData()},a.prototype.saveData=function(){if("undefined"!=typeof Storage){for(var a="",b=0;b<this.aLevelStore.length;b++)a+=this.aLevelStore[b],b<this.aLevelStore.length-1&&(a+=",");localStorage.setItem(this.saveDataId,a)}},a}();a.SaveDataHandler=b}(Utils||(Utils={}));var requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60,(new Date).getTime())}}(),previousTime,canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d");canvas.width=800,canvas.height=400;var canvasX,canvasY,canvasScaleX,canvasScaleY,div=document.getElementById("viewporter"),sound,audioType=0,muted=!1,splash,splashTimer=0,assetLib,preAssetLib,rotatePause=!1,manualPause=!1,isMobile=!1,gameState="loading",aLangs=new Array("EN"),curLang="",isBugBrowser=!1,isIE10=!1;navigator.userAgent.match(/MSIE\s([\d]+)/)&&(isIE10=!0);var deviceAgent=navigator.userAgent.toLowerCase();(deviceAgent.match(/(iphone|ipod|ipad)/)||deviceAgent.match(/(android)/)||deviceAgent.match(/(iemobile)/)||deviceAgent.match(/iphone/i)||deviceAgent.match(/ipad/i)||deviceAgent.match(/ipod/i)||deviceAgent.match(/blackberry/i)||deviceAgent.match(/bada/i))&&(isMobile=!0,deviceAgent.match(/(android)/)&&!/Chrome/.test(navigator.userAgent)&&(isBugBrowser=!0));var userInput=new Utils.UserInput(canvas,isBugBrowser);resizeCanvas(),window.onresize=function(){setTimeout(function(){resizeCanvas()},1)},document.addEventListener("visibilitychange",function(){document.hidden?Howler.mute():muted||Howler.unmute()},!1),window.addEventListener("load",function(){setTimeout(function(){resizeCanvas()},0),window.addEventListener("orientationchange",function(){resizeCanvas()},!1)}),isIE10||"undefined"==typeof window.AudioContext&&"undefined"==typeof window.webkitAudioContext&&-1!=navigator.userAgent.indexOf("Android")?audioType=0:(audioType=1,sound=new Howl({urls:["audio/sound.ogg","audio/sound.m4a"],sprite:{ballHit1:[0,400],ballHit2:[500,400],ballHit3:[1e3,400],bumper1:[1500,400],bumper2:[2e3,400],strike3:[2500,700],strike1:[3500,700],pot1:[4500,1e3],pot2:[6e3,1e3],pot3:[7500,1e3],explode:[9e3,3e3],score:[13e3,700],levelSuccess:[14500,800],strike2:[15500,500]}}));var panel,hud,background,totalScore=0,levelScore=0,levelNum=0,aLevelUps,levelBonusScore,bonusScore,aTutorials=new Array,panelFrame,oLogoData={},oLogoBut,table,cueBall,arrow,physics2D,gameTouchState,oPosData={prevBallX:0,prevBallY:0,stageX:0,stageY:0,targStageX:0,targStageY:0,startDragX:0,startDragY:0,startStageX:0,startStageY:0},levelWidth=800,levelHeight=480,shotsSinceLastPot,shotScore,aimX,aimY,targAimX,targAimY,aHolePos=new Array,buffer=40,aBalls,aHoles,levelButsPage=0,timer,timerRunning,aDynamites,aLevelData=new Array({timer:99,aData:[{type:"ball",p0:{x:610,y:240},p1:{x:99,y:240}},{type:"ball",p0:{x:505,y:240},p1:{x:99,y:240}},{type:"ball",p0:{x:400,y:240},p1:{x:99,y:240}},{type:"ball",p0:{x:202,y:315},p1:{x:99,y:315}},{type:"ball",p0:{x:202,y:155},p1:{x:99,y:155}},{type:"ball",p0:{x:202,y:240},p1:{x:99,y:240}},{type:"cueBall",p0:{x:276,y:264},p1:{x:276,y:264}},{type:"hole",p0:{x:694,y:384},p1:{x:694,y:384}},{type:"hole",p0:{x:400,y:400},p1:{x:400,y:400}},{type:"hole",p0:{x:107,y:384},p1:{x:107,y:384}},{type:"hole",p0:{x:694,y:97},p1:{x:694,y:97}},{type:"hole",p0:{x:400,y:80},p1:{x:400,y:80}},{type:"hole",p0:{x:107,y:97},p1:{x:107,y:97}},{type:"wall",p0:{x:710,y:127},p1:{x:710,y:354}},{type:"wall",p0:{x:90,y:127},p1:{x:90,y:354}},{type:"wall",p0:{x:436,y:401},p1:{x:663,y:400}},{type:"wall",p0:{x:138,y:401},p1:{x:365,y:400}},{type:"wall",p0:{x:436,y:81},p1:{x:663,y:80}},{type:"wall",p0:{x:138,y:81},p1:{x:365,y:80}}]},{timer:95,aData:[{type:"ball",p0:{x:550,y:170},p1:{x:99,y:170}},{type:"ball",p0:{x:550,y:310},p1:{x:99,y:310}},{type:"ball",p0:{x:620,y:210},p1:{x:99,y:210}},{type:"ball",p0:{x:620,y:270},p1:{x:99,y:270}},{type:"ball",p0:{x:470,y:210},p1:{x:99,y:210}},{type:"ball",p0:{x:470,y:270},p1:{x:99,y:270}},{type:"cueBall",p0:{x:200,y:241},p1:{x:200,y:241}},{type:"hole",p0:{x:694,y:384},p1:{x:694,y:384}},{type:"hole",p0:{x:400,y:400},p1:{x:400,y:400}},{type:"hole",p0:{x:107,y:384},p1:{x:107,y:384}},{type:"hole",p0:{x:694,y:97},p1:{x:694,y:97}},{type:"hole",p0:{x:400,y:80},p1:{x:400,y:80}},{type:"hole",p0:{x:107,y:97},p1:{x:107,y:97}},{type:"wall",p0:{x:710,y:127},p1:{x:710,y:354}},{type:"wall",p0:{x:90,y:127},p1:{x:90,y:354}},{type:"wall",p0:{x:436,y:401},p1:{x:663,y:400}},{type:"wall",p0:{x:138,y:401},p1:{x:365,y:400}},{type:"wall",p0:{x:436,y:81},p1:{x:663,y:80}},{type:"wall",p0:{x:138,y:81},p1:{x:365,y:80}}]},{timer:90,aData:[{type:"hole",p0:{x:694,y:384},p1:{x:694,y:384}},{type:"hole",p0:{x:400,y:400},p1:{x:400,y:400}},{type:"hole",p0:{x:107,y:384},p1:{x:107,y:384}},{type:"hole",p0:{x:694,y:97},p1:{x:694,y:97}},{type:"hole",p0:{x:400,y:80},p1:{x:400,y:80}},{type:"hole",p0:{x:107,y:97},p1:{x:107,y:97}},{type:"wall",p0:{x:710,y:127},p1:{x:710,y:354}},{type:"wall",p0:{x:90,y:127},p1:{x:90,y:354}},{type:"wall",p0:{x:436,y:401},p1:{x:663,y:400}},{type:"wall",p0:{x:138,y:401},p1:{x:365,y:400}},{type:"wall",p0:{x:436,y:81},p1:{x:663,y:80}},{type:"wall",p0:{x:138,y:81},p1:{x:365,y:80}}]},{timer:80,aData:[{type:"hole",p0:{x:694,y:384},p1:{x:694,y:384}},{type:"hole",p0:{x:400,y:400},p1:{x:400,y:400}},{type:"hole",p0:{x:107,y:384},p1:{x:107,y:384}},{type:"hole",p0:{x:694,y:97},p1:{x:694,y:97}},{type:"hole",p0:{x:400,y:80},p1:{x:400,y:80}},{type:"hole",p0:{x:107,y:97},p1:{x:107,y:97}},{type:"wall",p0:{x:710,y:127},p1:{x:710,y:354}},{type:"wall",p0:{x:90,y:127},p1:{x:90,y:354}},{type:"wall",p0:{x:436,y:401},p1:{x:663,y:400}},{type:"wall",p0:{x:138,y:401},p1:{x:365,y:400}},{type:"wall",p0:{x:436,y:81},p1:{x:663,y:80}},{type:"wall",p0:{x:138,y:81},p1:{x:365,y:80}}]},{timer:75,aData:[{type:"hole",p0:{x:694,y:384},p1:{x:694,y:384}},{type:"hole",p0:{x:400,y:400},p1:{x:400,y:400}},{type:"hole",p0:{x:107,y:384},p1:{x:107,y:384}},{type:"hole",p0:{x:694,y:97},p1:{x:694,y:97}},{type:"hole",p0:{x:400,y:80},p1:{x:400,y:80}},{type:"hole",p0:{x:107,y:97},p1:{x:107,y:97}},{type:"wall",p0:{x:710,y:127},p1:{x:710,y:354}},{type:"wall",p0:{x:90,y:127},p1:{x:90,y:354}},{type:"wall",p0:{x:436,y:401},p1:{x:663,y:400}},{type:"wall",p0:{x:138,y:401},p1:{x:365,y:400}},{type:"wall",p0:{x:436,y:81},p1:{x:663,y:80}},{type:"wall",p0:{x:138,y:81},p1:{x:365,y:80}}]},{timer:70,aData:[{type:"hole",p0:{x:694,y:384},p1:{x:694,y:384}},{type:"hole",p0:{x:400,y:400},p1:{x:400,y:400}},{type:"hole",p0:{x:107,y:384},p1:{x:107,y:384}},{type:"hole",p0:{x:694,y:97},p1:{x:694,y:97}},{type:"hole",p0:{x:400,y:80},p1:{x:400,y:80}},{type:"hole",p0:{x:107,y:97},p1:{x:107,y:97}},{type:"wall",p0:{x:710,y:127},p1:{x:710,y:354}},{type:"wall",p0:{x:90,y:127},p1:{x:90,y:354}},{type:"wall",p0:{x:436,y:401},p1:{x:663,y:400}},{type:"wall",p0:{x:138,y:401},p1:{x:365,y:400}},{type:"wall",p0:{x:436,y:81},p1:{x:663,y:80}},{type:"wall",p0:{x:138,y:81},p1:{x:365,y:80}}]},{timer:65,aData:[{type:"hole",p0:{x:694,y:384},p1:{x:694,y:384}},{type:"hole",p0:{x:400,y:400},p1:{x:400,y:400}},{type:"hole",p0:{x:107,y:384},p1:{x:107,y:384}},{type:"hole",p0:{x:694,y:97},p1:{x:694,y:97}},{type:"hole",p0:{x:400,y:80},p1:{x:400,y:80}},{type:"hole",p0:{x:107,y:97},p1:{x:107,y:97}},{type:"wall",p0:{x:710,y:127},p1:{x:710,y:354}},{type:"wall",p0:{x:90,y:127},p1:{x:90,y:354}},{type:"wall",p0:{x:436,y:401},p1:{x:663,y:400}},{type:"wall",p0:{x:138,y:401},p1:{x:365,y:400}},{type:"wall",p0:{x:436,y:81},p1:{x:663,y:80}},{type:"wall",p0:{x:138,y:81},p1:{x:365,y:80}}]},{timer:60,aData:[{type:"hole",p0:{x:694,y:384},p1:{x:694,y:384}},{type:"hole",p0:{x:400,y:400},p1:{x:400,y:400}},{type:"hole",p0:{x:107,y:384},p1:{x:107,y:384}},{type:"hole",p0:{x:694,y:97},p1:{x:694,y:97}},{type:"hole",p0:{x:400,y:80},p1:{x:400,y:80}},{type:"hole",p0:{x:107,y:97},p1:{x:107,y:97}},{type:"wall",p0:{x:710,y:127},p1:{x:710,y:354}},{type:"wall",p0:{x:90,y:127},p1:{x:90,y:354}},{type:"wall",p0:{x:436,y:401},p1:{x:663,y:400}},{type:"wall",p0:{x:138,y:401},p1:{x:365,y:400}},{type:"wall",p0:{x:436,y:81},p1:{x:663,y:80}},{type:"wall",p0:{x:138,y:81},p1:{x:365,y:80}}]},{timer:55,aData:[{type:"hole",p0:{x:694,y:384},p1:{x:694,y:384}},{type:"hole",p0:{x:400,y:400},p1:{x:400,y:400}},{type:"hole",p0:{x:107,y:384},p1:{x:107,y:384}},{type:"hole",p0:{x:694,y:97},p1:{x:694,y:97}},{type:"hole",p0:{x:400,y:80},p1:{x:400,y:80}},{type:"hole",p0:{x:107,y:97},p1:{x:107,y:97}},{type:"wall",p0:{x:710,y:127},p1:{x:710,y:354}},{type:"wall",p0:{x:90,y:127},p1:{x:90,y:354}},{type:"wall",p0:{x:436,y:401},p1:{x:663,y:400}},{type:"wall",p0:{x:138,y:401},p1:{x:365,y:400}},{type:"wall",p0:{x:436,y:81},p1:{x:663,y:80}},{type:"wall",p0:{x:138,y:81},p1:{x:365,y:80}}]},{timer:50,aData:[{type:"hole",p0:{x:694,y:384},p1:{x:694,y:384}},{type:"hole",p0:{x:400,y:400},p1:{x:400,y:400}},{type:"hole",p0:{x:107,y:384},p1:{x:107,y:384}},{type:"hole",p0:{x:694,y:97},p1:{x:694,y:97}},{type:"hole",p0:{x:400,y:80},p1:{x:400,y:80}},{type:"hole",p0:{x:107,y:97},p1:{x:107,y:97}},{type:"wall",p0:{x:710,y:127},p1:{x:710,y:354}},{type:"wall",p0:{x:90,y:127},p1:{x:90,y:354}},{type:"wall",p0:{x:436,y:401},p1:{x:663,y:400}},{type:"wall",p0:{x:138,y:401},p1:{x:365,y:400}},{type:"wall",p0:{x:436,y:81},p1:{x:663,y:80}},{type:"wall",p0:{x:138,y:81},p1:{x:365,y:80}}]});
loadPreAssets();